{"version":3,"file":"users-7147988b.js","sources":["../../src/api/users.js"],"sourcesContent":["import axios from 'axios';\n\n// Create axios instance for users API\nconst API_BASE_URL = import.meta.env.VITE_API_URL || 'http://localhost:5000/api';\nconst usersAPI = axios.create({\n  baseURL: `${API_BASE_URL}/users`,\n  headers: {\n    'Content-Type': 'application/json',\n  },\n});\n\n// Add token to requests\nusersAPI.interceptors.request.use(\n  (config) => {\n    const token = localStorage.getItem('token');\n    if (token) {\n      config.headers.Authorization = `Bearer ${token}`;\n    }\n    return config;\n  },\n  (error) => {\n    return Promise.reject(error);\n  }\n);\n\n// Handle response errors\nusersAPI.interceptors.response.use(\n  (response) => response,\n  (error) => {\n    if (error.response?.status === 401) {\n      localStorage.removeItem('token');\n      localStorage.removeItem('refreshToken');\n      window.location.href = '/login';\n    }\n    return Promise.reject(error);\n  }\n);\n\n// Users API functions\nexport const users = {\n  // Get current user profile\n  getProfile: async () => {\n    try {\n      const response = await usersAPI.get('/me');\n      return response.data;\n    } catch (error) {\n      throw new Error(error.response?.data?.message || 'Erreur lors de la récupération du profil');\n    }\n  },\n\n  // Update current user profile\n  updateProfile: async (userData) => {\n    try {\n      const response = await usersAPI.put('/me', userData);\n      return response.data;\n    } catch (error) {\n      throw new Error(error.response?.data?.message || 'Erreur lors de la mise à jour du profil');\n    }\n  },\n\n  // Change password\n  changePassword: async (passwordData) => {\n    try {\n      const response = await usersAPI.put('/me/password', passwordData);\n      return response.data;\n    } catch (error) {\n      throw new Error(error.response?.data?.message || 'Erreur lors du changement de mot de passe');\n    }\n  },\n\n  // Upload profile image\n  uploadAvatar: async (file) => {\n    try {\n      const formData = new FormData();\n      formData.append('avatar', file);\n      \n      const response = await usersAPI.post('/me/avatar', formData, {\n        headers: {\n          'Content-Type': 'multipart/form-data',\n        },\n      });\n      return response.data;\n    } catch (error) {\n      throw new Error(error.response?.data?.message || 'Erreur lors du téléchargement de l\\'image');\n    }\n  },\n\n  // Delete profile image\n  deleteAvatar: async () => {\n    try {\n      const response = await usersAPI.delete('/me/avatar');\n      return response.data;\n    } catch (error) {\n      throw new Error(error.response?.data?.message || 'Erreur lors de la suppression de l\\'image');\n    }\n  },\n\n  // Get user by ID (public profile)\n  getById: async (id) => {\n    try {\n      const response = await usersAPI.get(`/${id}`);\n      return response.data;\n    } catch (error) {\n      throw new Error(error.response?.data?.message || 'User not found');\n    }\n  },\n\n  // Get all users (admin only)\n  getAll: async (params = {}) => {\n    try {\n      const response = await usersAPI.get('/', { params });\n      return response.data;\n    } catch (error) {\n      throw new Error(error.response?.data?.message || 'Error fetching users');\n    }\n  },\n\n  // Update user status (admin only)\n  updateStatus: async (id, status) => {\n    try {\n      const response = await usersAPI.patch(`/${id}/status`, { status });\n      return response.data;\n    } catch (error) {\n      throw new Error(error.response?.data?.message || 'Erreur lors de la mise à jour du statut');\n    }\n  },\n\n  // Update user role (admin only)\n  updateRole: async (id, role) => {\n    try {\n      const response = await usersAPI.patch(`/${id}/role`, { role });\n      return response.data;\n    } catch (error) {\n      throw new Error(error.response?.data?.message || 'Erreur lors de la mise à jour du rôle');\n    }\n  },\n\n  // Delete user (admin only)\n  delete: async (id) => {\n    try {\n      const response = await usersAPI.delete(`/${id}`);\n      return response.data;\n    } catch (error) {\n      throw new Error(error.response?.data?.message || 'Error deleting user');\n    }\n  },\n\n  // Get user statistics\n  getStats: async (id) => {\n    try {\n      const response = await usersAPI.get(`/${id}/stats`);\n      return response.data;\n    } catch (error) {\n      throw new Error(error.response?.data?.message || 'Erreur lors de la récupération des statistiques');\n    }\n  },\n\n  // Search users\n  search: async (query, filters = {}) => {\n    try {\n      const params = { q: query, ...filters };\n      const response = await usersAPI.get('/search', { params });\n      return response.data;\n    } catch (error) {\n      throw new Error(error.response?.data?.message || 'Erreur lors de la recherche');\n    }\n  },\n\n  // Follow/Unfollow user\n  toggleFollow: async (id) => {\n    try {\n      const response = await usersAPI.post(`/${id}/follow`);\n      return response.data;\n    } catch (error) {\n      throw new Error(error.response?.data?.message || 'Erreur lors du suivi');\n    }\n  },\n\n  // Get user followers\n  getFollowers: async (id) => {\n    try {\n      const response = await usersAPI.get(`/${id}/followers`);\n      return response.data;\n    } catch (error) {\n      throw new Error(error.response?.data?.message || 'Erreur lors de la récupération des followers');\n    }\n  },\n\n  // Get user following\n  getFollowing: async (id) => {\n    try {\n      const response = await usersAPI.get(`/${id}/following`);\n      return response.data;\n    } catch (error) {\n      throw new Error(error.response?.data?.message || 'Erreur lors de la récupération des abonnements');\n    }\n  },\n\n  // Get user activity\n  getActivity: async (id, params = {}) => {\n    try {\n      const response = await usersAPI.get(`/${id}/activity`, { params });\n      return response.data;\n    } catch (error) {\n      throw new Error(error.response?.data?.message || 'Erreur lors de la récupération de l\\'activité');\n    }\n  },\n\n  // Update user preferences\n  updatePreferences: async (preferences) => {\n    try {\n      const response = await usersAPI.put('/me/preferences', preferences);\n      return response.data;\n    } catch (error) {\n      throw new Error(error.response?.data?.message || 'Erreur lors de la mise à jour des préférences');\n    }\n  },\n\n  // Get user notifications\n  getNotifications: async (params = {}) => {\n    try {\n      const response = await usersAPI.get('/me/notifications', { params });\n      return response.data;\n    } catch (error) {\n      throw new Error(error.response?.data?.message || 'Erreur lors de la récupération des notifications');\n    }\n  },\n\n  // Mark notification as read\n  markNotificationRead: async (notificationId) => {\n    try {\n      const response = await usersAPI.patch(`/me/notifications/${notificationId}/read`);\n      return response.data;\n    } catch (error) {\n      throw new Error(error.response?.data?.message || 'Erreur lors du marquage de la notification');\n    }\n  },\n\n  // Delete account\n  deleteAccount: async (password) => {\n    try {\n      const response = await usersAPI.delete('/me', { data: { password } });\n      return response.data;\n    } catch (error) {\n      throw new Error(error.response?.data?.message || 'Erreur lors de la suppression du compte');\n    }\n  }\n};\n\nexport default users;\n"],"names":["API_BASE_URL","usersAPI","axios","config","token","error","response","_a","users","_b","userData","passwordData","file","formData","id","params","status","role","query","filters","preferences","notificationId","password"],"mappings":"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"}